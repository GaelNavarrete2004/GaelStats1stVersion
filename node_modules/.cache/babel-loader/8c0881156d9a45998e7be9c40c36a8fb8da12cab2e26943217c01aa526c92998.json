{"ast":null,"code":"import { Buffer } from \"buffer\";\nconst CLIENT_ID = \"79f742e2bb194cc2b9756caebc221c22\";\nconst CLIENT_SECRET = \"344f257c69ba40458b8780bb44eb14ce\";\nconst REDIRECT_URI = \"http://localhost:3000/callback\";\nconst SCOPES = [\"user-read-private\", \"user-read-email\", \"user-top-read\", \"playlist-read-private\", \"playlist-modify-public\", \"playlist-modify-private\", \"user-library-read\", \"user-library-modify\"];\nexport const getAuthUrl = () => {\n  return \"https://accounts.spotify.com/authorize?\" + `client_id=${CLIENT_ID}&` + `response_type=code&` + `redirect_uri=${encodeURIComponent(REDIRECT_URI)}&` + `scope=${encodeURIComponent(SCOPES.join(\" \"))}`;\n};\nexport const getAccessToken = async code => {\n  try {\n    const body = new URLSearchParams({\n      grant_type: \"authorization_code\",\n      code,\n      redirect_uri: REDIRECT_URI\n    }).toString();\n\n    // Logs para verificar los valores antes de hacer la solicitud\n    console.log(\"Authorization Code:\", code);\n    console.log(\"Redirect URI:\", REDIRECT_URI);\n    console.log(\"Authorization Header:\", \"Basic \" + Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString(\"base64\"));\n    const response = await fetch(\"https://accounts.spotify.com/api/token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Authorization: \"Basic \" + Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString(\"base64\")\n      },\n      body: body\n    });\n    if (!response.ok) {\n      const errorDetails = await response.json();\n      console.error(\"Error fetching access token:\", errorDetails);\n      throw new Error(\"Failed to retrieve access token\");\n    }\n    const data = await response.json();\n    return data.access_token;\n  } catch (error) {\n    console.error(\"Error getting access token:\", error);\n    throw error;\n  }\n};\nexport const fetchFromSpotify = async (endpoint, token) => {\n  const response = await fetch(`https://api.spotify.com/v1${endpoint}`, {\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  if (!response.ok) {\n    const errorDetails = await response.json();\n    console.error(\"Error fetching data from Spotify:\", errorDetails);\n    throw new Error(\"Failed to fetch data from Spotify\");\n  }\n  return response.json();\n};","map":{"version":3,"names":["Buffer","CLIENT_ID","CLIENT_SECRET","REDIRECT_URI","SCOPES","getAuthUrl","encodeURIComponent","join","getAccessToken","code","body","URLSearchParams","grant_type","redirect_uri","toString","console","log","from","response","fetch","method","headers","Authorization","ok","errorDetails","json","error","Error","data","access_token","fetchFromSpotify","endpoint","token"],"sources":["C:/Users/gael1/OneDrive/Desktop/spotify/spotify-stats/src/spotifyAuth.js"],"sourcesContent":["import { Buffer } from \"buffer\";\r\n\r\nconst CLIENT_ID = \"79f742e2bb194cc2b9756caebc221c22\";\r\nconst CLIENT_SECRET = \"344f257c69ba40458b8780bb44eb14ce\";\r\nconst REDIRECT_URI = \"http://localhost:3000/callback\";\r\nconst SCOPES = [\r\n  \"user-read-private\",\r\n  \"user-read-email\",\r\n  \"user-top-read\",\r\n  \"playlist-read-private\",\r\n  \"playlist-modify-public\",\r\n  \"playlist-modify-private\",\r\n  \"user-library-read\",\r\n  \"user-library-modify\",\r\n];\r\n\r\nexport const getAuthUrl = () => {\r\n  return (\r\n    \"https://accounts.spotify.com/authorize?\" +\r\n    `client_id=${CLIENT_ID}&` +\r\n    `response_type=code&` +\r\n    `redirect_uri=${encodeURIComponent(REDIRECT_URI)}&` +\r\n    `scope=${encodeURIComponent(SCOPES.join(\" \"))}`\r\n  );\r\n};\r\n\r\nexport const getAccessToken = async (code) => {\r\n  try {\r\n    const body = new URLSearchParams({\r\n      grant_type: \"authorization_code\",\r\n      code,\r\n      redirect_uri: REDIRECT_URI,\r\n    }).toString();\r\n\r\n    // Logs para verificar los valores antes de hacer la solicitud\r\n    console.log(\"Authorization Code:\", code);\r\n    console.log(\"Redirect URI:\", REDIRECT_URI);\r\n    console.log(\"Authorization Header:\", \"Basic \" + Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString(\"base64\"));\r\n\r\n    const response = await fetch(\"https://accounts.spotify.com/api/token\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n        Authorization:\r\n          \"Basic \" +\r\n          Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString(\"base64\"),\r\n      },\r\n      body: body,\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorDetails = await response.json();\r\n      console.error(\"Error fetching access token:\", errorDetails);\r\n      throw new Error(\"Failed to retrieve access token\");\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data.access_token;\r\n  } catch (error) {\r\n    console.error(\"Error getting access token:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const fetchFromSpotify = async (endpoint, token) => {\r\n  const response = await fetch(`https://api.spotify.com/v1${endpoint}`, {\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  });\r\n\r\n  if (!response.ok) {\r\n    const errorDetails = await response.json();\r\n    console.error(\"Error fetching data from Spotify:\", errorDetails);\r\n    throw new Error(\"Failed to fetch data from Spotify\");\r\n  }\r\n\r\n  return response.json();\r\n};\r\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,QAAQ;AAE/B,MAAMC,SAAS,GAAG,kCAAkC;AACpD,MAAMC,aAAa,GAAG,kCAAkC;AACxD,MAAMC,YAAY,GAAG,gCAAgC;AACrD,MAAMC,MAAM,GAAG,CACb,mBAAmB,EACnB,iBAAiB,EACjB,eAAe,EACf,uBAAuB,EACvB,wBAAwB,EACxB,yBAAyB,EACzB,mBAAmB,EACnB,qBAAqB,CACtB;AAED,OAAO,MAAMC,UAAU,GAAGA,CAAA,KAAM;EAC9B,OACE,yCAAyC,GACzC,aAAaJ,SAAS,GAAG,GACzB,qBAAqB,GACrB,gBAAgBK,kBAAkB,CAACH,YAAY,CAAC,GAAG,GACnD,SAASG,kBAAkB,CAACF,MAAM,CAACG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE;AAEnD,CAAC;AAED,OAAO,MAAMC,cAAc,GAAG,MAAOC,IAAI,IAAK;EAC5C,IAAI;IACF,MAAMC,IAAI,GAAG,IAAIC,eAAe,CAAC;MAC/BC,UAAU,EAAE,oBAAoB;MAChCH,IAAI;MACJI,YAAY,EAAEV;IAChB,CAAC,CAAC,CAACW,QAAQ,CAAC,CAAC;;IAEb;IACAC,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEP,IAAI,CAAC;IACxCM,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEb,YAAY,CAAC;IAC1CY,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAE,QAAQ,GAAGhB,MAAM,CAACiB,IAAI,CAAC,GAAGhB,SAAS,IAAIC,aAAa,EAAE,CAAC,CAACY,QAAQ,CAAC,QAAQ,CAAC,CAAC;IAEhH,MAAMI,QAAQ,GAAG,MAAMC,KAAK,CAAC,wCAAwC,EAAE;MACrEC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACP,cAAc,EAAE,mCAAmC;QACnDC,aAAa,EACX,QAAQ,GACRtB,MAAM,CAACiB,IAAI,CAAC,GAAGhB,SAAS,IAAIC,aAAa,EAAE,CAAC,CAACY,QAAQ,CAAC,QAAQ;MAClE,CAAC;MACDJ,IAAI,EAAEA;IACR,CAAC,CAAC;IAEF,IAAI,CAACQ,QAAQ,CAACK,EAAE,EAAE;MAChB,MAAMC,YAAY,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;MAC1CV,OAAO,CAACW,KAAK,CAAC,8BAA8B,EAAEF,YAAY,CAAC;MAC3D,MAAM,IAAIG,KAAK,CAAC,iCAAiC,CAAC;IACpD;IAEA,MAAMC,IAAI,GAAG,MAAMV,QAAQ,CAACO,IAAI,CAAC,CAAC;IAClC,OAAOG,IAAI,CAACC,YAAY;EAC1B,CAAC,CAAC,OAAOH,KAAK,EAAE;IACdX,OAAO,CAACW,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;IACnD,MAAMA,KAAK;EACb;AACF,CAAC;AAED,OAAO,MAAMI,gBAAgB,GAAG,MAAAA,CAAOC,QAAQ,EAAEC,KAAK,KAAK;EACzD,MAAMd,QAAQ,GAAG,MAAMC,KAAK,CAAC,6BAA6BY,QAAQ,EAAE,EAAE;IACpEV,OAAO,EAAE;MACPC,aAAa,EAAE,UAAUU,KAAK;IAChC;EACF,CAAC,CAAC;EAEF,IAAI,CAACd,QAAQ,CAACK,EAAE,EAAE;IAChB,MAAMC,YAAY,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;IAC1CV,OAAO,CAACW,KAAK,CAAC,mCAAmC,EAAEF,YAAY,CAAC;IAChE,MAAM,IAAIG,KAAK,CAAC,mCAAmC,CAAC;EACtD;EAEA,OAAOT,QAAQ,CAACO,IAAI,CAAC,CAAC;AACxB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}